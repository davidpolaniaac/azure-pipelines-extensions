{
   "manifestVersion":1.0,
   "id":"GoogleAnalytics",
   "version":"0.0.2",
   "publisher":"ms-devlabs",
   "name":"Google Analytics Experiments",
   "description":"Google Analytics Experiments extension for Azure Pipelines.",
   "public":false,
   "icons":{
      "default":"images/icon.png",
      "large":"images/icon.png"
   },
   "categories":[
      "Azure Pipelines"
   ],
   "branding":{
      "color":"#FFFFFF",
      "theme":"light"
   },
   "content":{
      "details":{
         "path":"README.md"
      }
   },
   "targets":[
      {
         "id":"Microsoft.VisualStudio.Services.Cloud"
      },
      {
         "id":"Microsoft.TeamFoundation.Server",
         "version":"[15.3,)"
      }
   ],
   "contributions":[
      {
         "id":"GoogleAnalytics-endpoint-type",
         "description":"i18n: Service Connection for Google Analytics Experiments",
         "type":"ms.vss-endpoint.service-endpoint-type",
         "targets":[
            "ms.vss-endpoint.endpoint-types"
         ],
         "properties":{
            "name":"googleanalytics",
            "displayName":"Google Analytics",
            "url":"https://www.googleapis.com/analytics/v3",
            "authenticationSchemes":[
               {
                  "type":"ms.vss-endpoint.endpoint-auth-scheme-JWT",
                  "inputDescriptors":[
                     {
                        "id":"Audience",
                        "name":"i18n:Audience",
                        "description":"i18n:Audience for creating JWT",
                        "inputMode":"combo",
                        "isConfidential":false,
                        "validation":{
                           "isRequired":true,
                           "dataType":"string",
                           "maxLength":300
                        },
                        "values":{
                           "inputId":"tokenUrl",
                           "defaultValue":"https://accounts.google.com/o/oauth2/token",
                           "possibleValues":[
                              {
                                 "value":"https://accounts.google.com/o/oauth2/token",
                                 "displayValue":"https://accounts.google.com/o/oauth2/token"
                              }
                           ]
                        }
                     }
                  ]
               }
            ],
            "dataSources":[
               {
                  "name":"experimentList",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles/{{profileId}}/experiments",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchAccountId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchWebPropertyId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchProfileId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchExperiment",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles/{{profileId}}/experiments/{{experimentId}}",
                  "resultSelector":"jsonpath:$"
               },
               {
                  "name":"fetchData",
                  "endpointUrl":"{{endpoint.url}}/data/ga?ids={{ids}}&start-date={{startDate}}&end-date={{endDate}}&metrics={{metrics}}&dimensions={{dimensions}}",
                  "resultSelector":"jsonpath:$.rows[*]"
               }
            ]
         }
      },
      {
         "id":"Analytics-task",
         "type":"ms.vss-distributed-task.task",
         "targets":[
            "ms.vss-distributed-task.tasks"
         ],
         "properties":{
            "name":"Tasks/GoogleAnalyticsExperiments"
         }
      },
      {
         "id":"Experiment-OverviewTab",
         "type":"ms.vss-web.tab",
         "targets":[
            "ms.vss-releaseManagement-web.release-environment-editor-tab"
         ],
         "properties":{
            "name":"Google Analytics",
            "description":"Shows the status of builds in your team project.",
            "uri":"UIContribution/static/experiment-overview.html",
            "registeredObjectId":"registeredEnvironmentObject",
            "dynamic":true
         }
      }
   ],
   "screenshots":[
      {
         "path":"images/1.JPG"
      },
      {
         "path":"images/2.JPG"
      }
   ],
   "files":[
      {
         "path":"Tasks/GoogleAnalyticsExperiments",
         "addressable":false
      },
      {
         "path":"UIContribution/static/experiment-overview.html",
         "addressable":true
      },
      {
         "path":"UIContribution/static/css",
         "addressable":true
      },
      {
         "path":"UIContribution/dist",
         "addressable":true
      },
      {
         "path":"images",
         "addressable":true
      },
      {
         "path":"UIContribution/node_modules/vss-web-extension-sdk/lib",
         "addressable":true,
         "packagePath":"UIContribution/lib"
      }
   ],
   "scopes":[
      "vso.build",
      "vso.release",
      "vso.serviceendpoint",
      "vso.serviceendpoint_query"
   ]
}
